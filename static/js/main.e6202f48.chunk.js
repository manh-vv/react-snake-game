(this["webpackJsonpreact-snake-game"]=this["webpackJsonpreact-snake-game"]||[]).push([[0],{13:function(t,e,i){},14:function(t,e,i){},15:function(t,e,i){"use strict";i.r(e);var n=i(0),a=i.n(n),s=i(7),h=i.n(s),o=(i(13),i(5)),r=(i(14),i(1)),c=i(2),u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(r.a)(this,t),this.x=e,this.y=i}return Object(c.a)(t,[{key:"move",value:function(t,e){return this.x+=t,this.y+=e,this}},{key:"clone",value:function(){return new t(this.x,this.y)}}]),t}(),l={w:600,h:400,interval:20},d=[1,0],f=[-1,0],v=[0,1],y=[0,-1],m=300,w=20;function p(t,e){return Math.floor(Math.random()*(e-t))+t}function g(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,i=p(e,t-e);i-=i%e;var n=p(e,t-e);return new u(i,n-=n%e)}var k=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;Object(r.a)(this,t),this.loc=e,this.size=i,this.loc||this.eated()}return Object(c.a)(t,[{key:"eated",value:function(){this.loc=g(Math.min(l.w,l.h),20)}},{key:"update",value:function(t){t.fillStyle="#ff0000",t.fillRect(this.loc.x,this.loc.y,this.size,this.size)}}]),t}(),b=i(3),D=function(){function t(e){Object(r.a)(this,t),this.gridSize=20,this.interval=l.interval,this.objects=[],this.state=0,this.container=e,this.init()}return Object(c.a)(t,[{key:"init",value:function(){var t=this;if(this.container){var e=getComputedStyle(this.container),i=document.createElement("canvas");this.canvas=i,this.ctx=i.getContext("2d"),i.width=l.w=parseInt(e.getPropertyValue("width")),i.height=l.h=parseInt(e.getPropertyValue("height")),i.tabIndex=1,i.autofocus=!0,i.onkeydown=function(e){return t.onKeyDown(e)},i.setAttribute("style","border: 1px dotted gray;"),this.container.appendChild(i)}}},{key:"showGrid",value:function(){this.ctx.lineWidth=1,this.ctx.strokeStyle="#000000";for(var t=this.gridSize;t<this.canvas.width;t+=this.gridSize)this.drawLine(t,0,t,this.canvas.height);for(var e=this.gridSize;e<this.canvas.height;e+=this.gridSize)this.drawLine(0,e,this.canvas.width,e)}},{key:"drawLine",value:function(t,e,i,n){var a=this.ctx;a.beginPath(),a.moveTo(t,e),a.lineTo(i,n),a.stroke()}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.interval;this.state=1,this.interval=t,this.update()}},{key:"stop",value:function(){this.state=0}},{key:"onKeyDown",value:function(t){var e,i=Object(b.a)(this.objects);try{for(i.s();!(e=i.n()).done;){var n=e.value;"function"==typeof n.onKeyDown&&n.onKeyDown(t,this)}}catch(a){i.e(a)}finally{i.f()}}},{key:"update",value:function(){var t=this,e=Date.now();this.clear(),this.showGrid();var i,n=Object(b.a)(this.objects);try{for(n.s();!(i=n.n()).done;){i.value.update(this.ctx)}}catch(h){n.e(h)}finally{n.f()}var a=Date.now()-e;if(a>this.interval)throw new Error("Interval is too short for update: ".concat(a));var s=this.interval-a;1===this.state&&setTimeout((function(){return t.update()}),s)}},{key:"addObject",value:function(t){t.gameFrame=this,this.objects.push(t)}}]),t}(),j=function(){function t(e,i){Object(r.a)(this,t),this.head=g(Math.min(l.w,l.h),20),this.size=20,this.curDir=d,this.step=w,this.speed=m,this._isDeath=!1,this.tails=[],i&&(this.head=i),this.food=e}return Object(c.a)(t,[{key:"handleEat",value:function(t){this.tails.push(this.head),this.head=t,"function"==typeof this.onScoreChange&&this.onScoreChange(this.tails.length)}},{key:"update",value:function(t){t.fillStyle="#00CC99";var e,i=Object(b.a)(this.tails);try{for(i.s();!(e=i.n()).done;){var n=e.value;t.fillRect(n.x,n.y,this.size,this.size)}}catch(a){i.e(a)}finally{i.f()}t.fillRect(this.head.x,this.head.y,this.size,this.size)}},{key:"move",value:function(){var t=this;if(!this.isDeath){var e=this.head.clone().move(this.curDir[0]*this.step,this.curDir[1]*this.step);this.isDeath=0>e.x||e.x>l.w-this.step||0>e.y||e.y>l.h-this.step,this.isDeath?console.info("The snake is death"):(e.x===this.food.loc.x&&e.y===this.food.loc.y?(this.handleEat(this.food.loc.clone()),this.food.eated()):(this.tails.push(this.head.clone()),this.tails.shift(),this.head.move(this.curDir[0]*this.step,this.curDir[1]*this.step)),setTimeout((function(){return t.move()}),this.speed))}}},{key:"onKeyDown",value:function(t){switch(console.debug("hit key:",t.key),t.key){case"ArrowDown":this.curDir=v;break;case"ArrowUp":this.curDir=y;break;case"ArrowRight":this.curDir=d;break;case"ArrowLeft":this.curDir=f;break;case"c":this.isDeath=!1,this.move();break;default:return void console.log("-- unknown key:",t.key)}}},{key:"isDeath",set:function(t){this._isDeath=t,t?this.gameFrame.stop():this.gameFrame.start(),"function"==typeof this.onDeath&&this.onDeath(t)},get:function(){return this._isDeath}}]),t}();var O=function(){var t=Object(n.useRef)(),e=Object(n.useState)(0),i=Object(o.a)(e,2),s=i[0],h=i[1],r=Object(n.useState)(!1),c=Object(o.a)(r,2),u=c[0],l=c[1],d=Object(n.useState)(new j),f=Object(o.a)(d,1)[0];return Object(n.useEffect)((function(){var e=new D(t.current);f.food=new k,f.onScoreChange=function(t){return h(t)},f.onDeath=function(t){return l(t)},e.addObject(f),e.addObject(f.food),e.start(),f.move()}),[f]),a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{id:"game-container",ref:t}),a.a.createElement("div",null,a.a.createElement("span",null,"Score:")," ",a.a.createElement("span",null,s)),a.a.createElement("div",null,a.a.createElement("span",null,"Is death:")," ",a.a.createElement("span",null,u?"TRUE":"FALSE")),a.a.createElement("div",null,a.a.createElement("button",{onClick:function(){f.tails=[],h(0)}},"Reset")))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));h.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(O,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},8:function(t,e,i){t.exports=i(15)}},[[8,1,2]]]);
//# sourceMappingURL=main.e6202f48.chunk.js.map